<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>08-partition-data.py &mdash; fluvius 0.1 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/custom.css" type="text/css" />
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="09-MLP-grid-search.py" href="09-MLP-grid-search.html" />
    <link rel="prev" title="07-remove-bad-obs.py" href="07-remove-bad-obs.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> fluvius
            <img src="../_static/logo.jpg" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Home</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../index.html">Fluvius</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../preamble/00a-background.html">Background</a></li>
<li class="toctree-l1"><a class="reference internal" href="../preamble/00b-project-goals.html">Project goals</a></li>
<li class="toctree-l1"><a class="reference internal" href="../preamble/00c-requirements.html">Requirements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../preamble/00d-quickstart.html">Quickstart</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Command Line Scripts</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="01-usgs-station-acquire.html">01-usgs-station-acquire.py</a></li>
<li class="toctree-l1"><a class="reference internal" href="02-preprocess-data.html">02-preprocess-data.py</a></li>
<li class="toctree-l1"><a class="reference internal" href="03-image-join.html">03-image-join.py</a></li>
<li class="toctree-l1"><a class="reference internal" href="04-data-merge.html">04-data-merge.py</a></li>
<li class="toctree-l1"><a class="reference internal" href="05-prep-qa-chip-dataset.html">05-prep-qa-chip-dataset.py</a></li>
<li class="toctree-l1"><a class="reference internal" href="06a-download-chips-for-qa.html">06a-download-chips-for-qa.py</a></li>
<li class="toctree-l1"><a class="reference internal" href="06b-upload-good-chips-list.html">06b-upload-good-chips-list.py</a></li>
<li class="toctree-l1"><a class="reference internal" href="07-remove-bad-obs.html">07-remove-bad-obs.py</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">08-partition-data.py</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#Named Arguments">Named Arguments</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="09-MLP-grid-search.html">09-MLP-grid-search.py</a></li>
<li class="toctree-l1"><a class="reference internal" href="10-compile-grid-search-results.html">10-compile-grid-search-results.py</a></li>
<li class="toctree-l1"><a class="reference internal" href="11-fit-top-model.html">11-fit-top-model.py</a></li>
<li class="toctree-l1"><a class="reference internal" href="12-prediction-inputs.html">12-prediction-inputs.py</a></li>
<li class="toctree-l1"><a class="reference internal" href="13-predict-tabular.html">13-predict-tabular.py</a></li>
<li class="toctree-l1"><a class="reference internal" href="14-make-prediction-chips.html">14-make-prediction-chips.py</a></li>
<li class="toctree-l1"><a class="reference internal" href="15-prep-data-for-app.html">15-prep-data-for-app.py</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Internals</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../fluvius.html">Classes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../utils.html">Utility Functions</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">fluvius</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>08-partition-data.py</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/csp-inc/fluvius/blob/main/docs/source/bin/08-partition-data.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="partition-data-py">
<h1>08-partition-data.py<a class="headerlink" href="#partition-data-py" title="Permalink to this headline"></a></h1>
<p>This script develops the partitions used to train and evaluate fluvius models.
A first-phase partition divides the sites into either a training or a test set.
Sites in the test set are never seen by the model during training, including the
hyperparameter grid search used to identify the top-performing model. Sites that
appear in the training set are further partitioned into train and validation
sets over k-folds. Several parameters involved in the partition are
hard-coded.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>usage: 08-partition-data.py [-h] [--day-tolerance DAY_TOLERANCE]
                            [--cloud-thr CLOUD_THR]
                            [--buffer-distance BUFFER_DISTANCE]
                            [--mask-method1 {lulc,scl}]
                            [--mask-method2 {mndwi,ndvi,&quot;&quot;}]
                            [--n-folds N_FOLDS] [--seed SEED]
</pre></div>
</div>
<section id="Named Arguments">
<h2>Named Arguments<a class="headerlink" href="#Named Arguments" title="Permalink to this headline"></a></h2>
<dl class="option-list">
<dt><kbd>--day-tolerance</kbd></dt>
<dd><p>Days of search around sample date for a matching Sentinel             2 image.</p>
<p>Default: 8</p>
</dd>
<dt><kbd>--cloud-thr</kbd></dt>
<dd><p>Percent of cloud cover acceptable in the Sentinel tile             corresponding to the sample. If this threshold is surpassed,             no Sentinel image chip will be collected for the sample.</p>
<p>Default: 80</p>
</dd>
<dt><kbd>--buffer-distance</kbd></dt>
<dd><p>Square search radius (in meters) to use for reflectance data             aggregation. This determines the size of the image chip that will             be extracted and processed.</p>
<p>Default: 500</p>
</dd>
<dt><kbd>--mask-method1</kbd></dt>
<dd><p>Possible choices: lulc, scl</p>
<p>Which data to use for masking (removing) non-water in order             to calculate aggreated reflectance values for only water pixels?             Choose (“scl”) to water pixels as identified based on the             Scene Classification Layer that accompanies the Snetinel tile,             or (“lulc”) to use Impact Observatory’s Land-Use/Land-Cover             layer to identify water, and the Scene Classification Layer to             remove clouds. Using “lulc” is strongly recommended.</p>
<p>Default: “lulc”</p>
</dd>
<dt><kbd>--mask-method2</kbd></dt>
<dd><p>Possible choices: mndwi, ndvi, “”</p>
<p>Which additional normalized index to use, if any, to update         the mask to remove errors of ommission (pixels classified as water         that shouldn’t be) prior to calculated aggregated reflectance? If         “ndvi”, then only pixels with an NDVI value less than 0.25         will be retained. If “mndwi” (recommended) then only pixels with an         MNDWI value greater than 0 will be retained. Of “”, then no         secondary mask is used.</p>
<p>Default: “mndwi”</p>
</dd>
<dt><kbd>--n-folds</kbd></dt>
<dd><p>The number of folds to create for the training / validation             set when fitting models using k-fold cross-validation.</p>
<p>Default: 5</p>
</dd>
<dt><kbd>--seed</kbd></dt>
<dd><p>The seed (an integer) used to initialize the pseudorandom             number generator for use in partitioning data.</p>
<p>Default: 123</p>
</dd>
</dl>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="07-remove-bad-obs.html" class="btn btn-neutral float-left" title="07-remove-bad-obs.py" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="09-MLP-grid-search.html" class="btn btn-neutral float-right" title="09-MLP-grid-search.py" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Conservation Science Partners.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>